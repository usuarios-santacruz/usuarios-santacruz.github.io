(window.agentWebpackJsonp=window.agentWebpackJsonp||[]).push([[8],{649:function(e,t,a){"use strict";var n=a(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(144),n=n(a(339)),a=a(708),a=(0,i.connect)(function(e){return e})((0,n.default)(a.Advert,"Advert"));t.default=a},655:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isEmail",{enumerable:!0,get:function(){return n.isEmail}}),Object.defineProperty(t,"isNumber",{enumerable:!0,get:function(){return n.isNumber}}),Object.defineProperty(t,"isURL",{enumerable:!0,get:function(){return n.isURL}});var n=a(657)},657:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isURL=t.isNumber=t.isEmail=void 0;t.isEmail=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)};t.isNumber=function(e){return/^([0-9])*$/.test(e)};t.isURL=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?/.test(e)}},708:function(e,t,a){"use strict";var n=a(5);Object.defineProperty(t,"__esModule",{value:!0}),t.Advert=void 0;var i=n(a(73)),o=n(a(74)),r=n(a(340)),c=n(a(142)),s=n(a(143)),d=n(a(98)),l=n(a(28)),u=n(a(23)),v=a(16),h=a(22),f=a(29),p=n(a(24)),m=a(655),g=a(81),y=a(50);function _(a){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=(0,d.default)(a);return t=n?(e=(0,d.default)(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),(0,s.default)(this,t)}}var w=!1,b="",a=function(e){(0,c.default)(a,e);var t=_(a);function a(e){return(0,i.default)(this,a),(e=t.call(this,e)).handleClick=e.handleClick.bind((0,r.default)(e)),e.handleClose=e.handleClose.bind((0,r.default)(e)),e.handleOnLoad=e.handleOnLoad.bind((0,r.default)(e)),e.handleDragStart=e.handleDragStart.bind((0,r.default)(e)),e.handleHashChange=e.handleHashChange.bind((0,r.default)(e)),e.handleMouseUp=e.handleMouseUp.bind((0,r.default)(e)),e.state={clicked:!1},e}return(0,o.default)(a,[{key:"componentDidMount",value:function(){window.addEventListener("hashchange",this.handleHashChange),document.body&&document.body.addEventListener("mouseup",this.handleMouseUp)}},{key:"handleMouseUp",value:function(){var e=this;b=location.href;function t(){b!==location.href&&(b=location.href,e.handleHashChange())}setTimeout(function(){window.requestAnimationFrame?requestAnimationFrame(t):t()},500)}},{key:"componentDidUpdate",value:function(){var t,e,a,n=this.props,i=n.dispatch,o=n.agentConfig,r=p.default.getHeight,c=p.default.searchInsideShadowRoot,s=c(".".concat(h.KEY__ADVERT));function d(e){for(var t,a,n=parseInt(e.style.fontSize.replace("px",""));135<r(e)&&1<n;)e.style.fontSize="".concat(n-=1,"px"),t=a=t=void 0,t=c(".aivochat-advert-content"),a=c(".aivochat-advert-text"),t=r(t),(a=r(a))<t&&(a=(t-a)/2,c(".aivochat-advert-text")[0].style.top=a)}0<s.length&&((t=this.getAd())&&(e=1e3*parseInt(t.delay),n=0<=(a=location.href).indexOf("https://")?8:7,a=location.href.substring(n,location.href.length),"*"!==t.host.substring(t.host.length-1)?a===t.host&&(s[0].classList.remove("show"),setTimeout(function(){var e;s[0].classList.add("show"),w||(i((0,y.setAdvertView)(t.id)),w=!0,(0,f.bringToFront)(".".concat(h.KEY__ADVERT),"2147483645"),window[h.KEY__SDK]._onShowAdvert&&window[h.KEY__SDK]._onShowAdvert(),e=[{action:"advert_id",param:t.id},{action:"event_type",param:"showAd-chat"},{action:"event_label",param:"show advert"}],(0,g.setEventAnalytics)(o.user.id,o.app.id,window.navigator.userAgent,e))},e)):0<=a.indexOf(t.host.substring(0,t.host.length-2))&&(s[0].classList.remove("show"),setTimeout(function(){var e;s[0].classList.add("show"),w||(i((0,y.setAdvertView)(t.id)),w=!0,(0,f.bringToFront)(".".concat(h.KEY__ADVERT),"2147483645"),window[h.KEY__SDK]._onShowAdvert&&window[h.KEY__SDK]._onShowAdvert(),e=[{action:"advert_id",param:t.id},{action:"event_type",param:"showAd-chat"},{action:"event_label",param:"show advert"}],(0,g.setEventAnalytics)(o.user.id,o.app.id,window.navigator.userAgent,e))},e)),1===parseInt(t.proactivity_type_id)&&(c(".aivochat-advert-close")[0].classList.add("aivochat-advert.show"),c(".aivochat-advert-close")[0].classList.remove("aivochat-advert.hide"),setTimeout(function(){d(c(".aivochat-advert-text")[0])},e))))}},{key:"handleClick",value:function(e){e.preventDefault();var t=this.props.dispatch,a=this.props.agentConfig,n=this.getAd(),e={id:a.user.id,type:1};t((0,y.openWindow)()),t((0,y.sendMessage)(n.question,e,a.app.id)),t((0,y.setAdvertClick)(n.id)),this.setState({clicked:!0})}},{key:"handleClose",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({clicked:!0})}},{key:"handleDragStart",value:function(e){e.preventDefault()}},{key:"handleOnLoad",value:function(e){e.preventDefault()}},{key:"handleHashChange",value:function(){this.update(),this.setState({clicked:!1})}},{key:"getAd",value:function(){var e=this.props.agentConfig;return e.proactivities?e.proactivities[0]:void 0}},{key:"update",value:function(){var t=this,e=this.props,a=e.agentConfig,n=e.dispatch;p.default.getSettings(a.app.id,function(e){e.proactivity&&e.proactivities&&(w=!1,t.setState({clicked:!1}),n((0,y.setConfig)({proactivities:e.proactivities})))})}},{key:"render",value:function(){var t=this,a=this.getAd(),n=function(e){switch(parseInt(e)){case 1:return l.default.createElement("div",{className:"aivochat-advert-content",style:{backgroundColor:a.color_background}},l.default.createElement("div",{className:"aivochat-advert-padding"},l.default.createElement("div",{className:"aivochat-advert-text",style:{color:a.color}},"".concat(a.welcome_message))),l.default.createElement("div",{className:"aivochat-advert-corner ".concat(a.image_location),style:{borderBottomColor:a.color_background}}),l.default.createElement("div",{className:"aivochat-advert-close",style:{color:a.color},onClick:t.handleClose},l.default.createElement("i",{className:"material-icons"},"close")));case 2:return l.default.createElement("div",{className:"aivochat-advert-content"},l.default.createElement("img",{className:"aivochat-advert-image",src:(0,m.isURL)(a.image_url)?a.image_url:"".concat(v.Mn7lpVG,"/").concat(a.image_url),onLoad:t.handleOnLoad,onDragStart:t.handleDragStart}),l.default.createElement("div",{className:"aivochat-advert-close",style:{color:a.color},onClick:t.handleClose},l.default.createElement("i",{className:"material-icons"},"close")),l.default.createElement("div",{className:"aivochat-advert-padding"}));default:return l.default.createElement("div",null)}};return l.default.createElement("div",null,function(){if(!t.state.clicked&&void 0!==a&&void 0!==a.proactivity_type_id){var e=1===parseInt(a.proactivity_type_id)?"text":"image";return l.default.createElement("div",{className:"".concat(h.KEY__ADVERT," ").concat(e," ").concat(a.image_location),onClick:t.handleClick},n(a.proactivity_type_id))}}())}}]),a}(l.default.Component);(t.Advert=a).propTypes={agentConfig:u.default.object,dispatch:u.default.func}}}]);